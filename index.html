<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TRADER SIAM X - Quotex Signal Board</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <style>
    .title-glow{text-shadow:0 0 10px #34d399,0 0 20px #34d399,0 0 30px #34d399;}
    @keyframes hueRotate{0%{filter:hue-rotate(0deg);}100%{filter:hue-rotate(360deg);} }
    .color-cycle{animation:hueRotate 4s linear infinite alternate;}
    .signal-call{color:#22c55e;font-weight:600;}
    .signal-put{color:#ef4444;font-weight:600;}
    @keyframes fadeScaleIn{0%{opacity:0;transform:scale(.8);}100%{opacity:1;transform:scale(1);} }
    .fade-scale-in{animation:fadeScaleIn .8s ease forwards;}
  </style>
</head>
<body class="min-h-screen bg-gray-900 text-white flex flex-col items-center py-10 px-4" x-data="{showPopup:true}">
  <!-- Popup -->
  <div x-show="showPopup" x-transition class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50">
    <div class="bg-gray-800 rounded-xl p-6 w-80 max-w-full relative text-center text-white shadow-lg">
      <button @click="showPopup=false" class="absolute top-3 right-3 text-gray-400 hover:text-gray-200 font-bold text-xl focus:outline-none" aria-label="Close popup">&times;</button>
      <p class="text-lg font-semibold fade-scale-in">Free for 7 days trial</p>
    </div>
  </div>

  <h1 class="text-4xl font-extrabold mb-8 text-green-400 title-glow">TRADER&nbsp;SIAM&nbsp;X</h1>

  <div x-data="signalBoard()" class="w-full max-w-6xl bg-gray-800 rounded-2xl shadow-lg p-6">
    <!-- Timeframe select -->
    <div class="mb-6">
      <label for="timeframe" class="block mb-2 font-semibold text-lg">Select Timeframe (Minutes per candle):</label>
      <select id="timeframe" x-model="selectedTimeframe" class="w-32 bg-gray-700 rounded-lg p-2 text-white focus:outline-none">
        <option value="1">1</option>
        <option value="5">5</option>
        <option value="15">15</option>
        <option value="30">30</option>
        <option value="60">60</option>
      </select>
    </div>

    <h3 class="text-xl font-semibold mb-4 color-cycle">SELECT MARKETS</h3>

    <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-3 mb-6 max-h-96 overflow-y-auto pr-2 text-xs">
      <template x-for="(market,index) in markets" :key="index">
        <label class="flex items-center space-x-2 bg-gray-700 rounded-lg p-2 cursor-pointer hover:bg-gray-600 transition">
          <input type="checkbox" x-model="market.selected" class="h-4 w-4 text-green-500 rounded focus:ring-0" />
          <span x-text="market.name" class="flex-1"></span>
        </label>
      </template>
    </div>

    <button @click="generateSignals" class="w-full py-3 bg-green-600 hover:bg-green-500 rounded-xl text-lg font-semibold transition">Generate Signals (30 min)</button>

    <div x-show="signals.length" x-transition.opacity.duration.500ms class="mt-8 space-y-4 max-h-96 overflow-y-auto">
      <h3 class="text-xl font-semibold">Generated Signals (next 30 minutes)</h3>
      <template x-for="(sig,idx) in signals" :key="idx">
        <div x-transition.scale.duration.400ms class="bg-gray-700 rounded-xl p-4 flex items-center justify-between">
          <span class="text-lg" :class="sig.dir==='CALL'?'signal-call':'signal-put'" x-text="sig.text"></span>
        </div>
      </template>
    </div>
  </div>

<script>
function signalBoard(){
  return {
    selectedTimeframe:'1',
    markets:[
      'EUR/USD OTC','GBP/USD OTC','USD/JPY OTC','AUD/USD OTC','USD/CHF OTC','USD/CAD OTC',
      'BTC/USD OTC','ETH/USD OTC','EUR/USD','GBP/USD','USD/JPY','AUD/USD','USD/CHF','USD/CAD',
      'EUR/JPY','EUR/GBP','GBP/JPY','NZD/USD'
    ].map(n=>({name:n,selected:false})),
    signals:[],
    formatTime(d){ return d.toTimeString().slice(0,5); },

    generateDummyPriceData(m,p){
      // Generate dummy prices with random walk
      let pr=[100+Math.random()*50];
      for(let i=1;i<p;i++){
        pr.push(Math.max(1,pr[i-1]+(Math.random()-0.5)*2));
      }
      return pr;
    },

    simpleMA(d,per){
      if(d.length<per) return null;
      return d.slice(-per).reduce((a,b)=>a+b,0)/per;
    },

    rsi(data, period=14){
      if(data.length < period+1) return null;
      let gains=0, losses=0;
      for(let i=data.length-period; i < data.length; i++){
        let diff = data[i] - data[i-1];
        if(diff>0) gains += diff;
        else losses -= diff;
      }
      if(losses === 0) return 100;
      let rs = gains / losses;
      return 100 - (100 / (1 + rs));
    },

    macd(data, fast=12, slow=26, signal=9){
      // Simple MACD implementation with EMA approximation via SMA for demo
      if(data.length < slow+signal) return null;
      const ema = (arr, length) => {
        let k = 2/(length+1);
        let emaArray = [arr.slice(0,length).reduce((a,b)=>a+b,0)/length];
        for(let i=length; i<arr.length; i++){
          emaArray.push(arr[i]*k + emaArray[emaArray.length-1]*(1-k));
        }
        return emaArray;
      }
      let emaFast = ema(data, fast);
      let emaSlow = ema(data, slow);
      let macdLine = [];
      for(let i=0; i<emaSlow.length; i++){
        macdLine.push(emaFast[i+(slow - fast)] - emaSlow[i]);
      }
      let signalLine = ema(macdLine, signal);
      if(signalLine.length===0) return null;
      return macdLine[macdLine.length-1] - signalLine[signalLine.length-1];
    },

    generateSignals(){
      this.signals = [];
      const tf = this.selectedTimeframe==='60'?'H1':this.selectedTimeframe+'M';
      let now = new Date();
      now.setSeconds(0,0);
      const bars = 30; // next 30 minutes, one per minute

      this.markets.forEach(mk=>{
        if(!mk.selected) return;

        const price = this.generateDummyPriceData(mk.name, bars+50); // generate more for indicators

        for(let i=0; i<bars; i++){
          const slice = price.slice(i,i+50);

          // Moving Averages
          const ma5 = this.simpleMA(slice, 5);
          const ma10 = this.simpleMA(slice, 10);
          if(ma5 === null || ma10 === null) continue;

          // RSI
          const rsiVal = this.rsi(slice, 14);
          if(rsiVal === null) continue;

          // MACD Histogram
          const macdHist = this.macd(slice);
          if(macdHist === null) continue;

          // Decision Logic:
          // CALL if: ma5 > ma10 AND RSI between 30-70 AND macdHist > 0
          // PUT if: ma5 < ma10 AND RSI between 30-70 AND macdHist < 0
          // Override: if RSI < 30 -> Strong Oversold -> CALL
          // Override: if RSI > 70 -> Strong Overbought -> PUT

          let dir = 'PUT';
          if(rsiVal < 30){
            dir = 'CALL';
          } else if(rsiVal > 70){
            dir = 'PUT';
          } else if(ma5 > ma10 && macdHist > 0){
            dir = 'CALL';
          } else if(ma5 < ma10 && macdHist < 0){
            dir = 'PUT';
          }

          const t = new Date(now.getTime() + (i+1)*60000);
          const text = `${tf};${mk.name.replace(/\//g,'').replace(/\s/g,'')};${this.formatTime(t)};${dir}`;
          this.signals.push({text, dir});
        }

        mk.selected = false;
      });

      this.$nextTick(()=>{
        if(this.signals.length) document.documentElement.scrollTo({top:document.body.scrollHeight, behavior:'smooth'});
      });
    }
  };
}
</script>
</body>
</html>
